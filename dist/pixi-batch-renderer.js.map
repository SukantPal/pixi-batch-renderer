{"version":3,"file":"pixi-batch-renderer.js","sources":["../node_modules/tslib/tslib.es6.js","../src/redirects/Redirect.ts","../src/redirects/AttributeRedirect.ts","../src/BatchGenerator.ts","../src/Batch.ts","../src/GeometryPacker.ts","../src/resolve/resolveConstantOrProperty.ts","../src/resolve/resolveFunctionOrProperty.ts","../src/BatchRenderer.ts","../src/BatchRendererPluginFactory.ts","../src/ShaderGenerator.ts","../src/index.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","/**\n * A redirect is used to transfer data from the display\n * object to the shader program.\n *\n * @memberof PIXI.brend\n * @class\n */\nexport class Redirect\n{\n    public source: string | Function;\n    public glslIdentifer: string;\n\n    constructor(source: string | Function, glslIdentifer: string)\n    {\n        /**\n         * Source property on a `PIXI.DisplayObject` that\n         * holds the data being transferred. This can also\n         * be a callback that returns the data.\n         *\n         * @member {string | Function}\n         */\n        this.source = source;\n\n        /**\n         * GLSL variable that will hold the data.\n         *\n         * @member {string}\n         */\n        this.glslIdentifer = glslIdentifer;\n    }\n}\n\nexport default Redirect;\n","import * as PIXI from 'pixi.js';\nimport { Redirect } from './Redirect';\n\n/**\n * An attribute-redirect describes how the batch renderer will\n * aggregate shader attributes.\n *\n * @memberof PIXI.brend\n * @class\n * @extends PIXI.brend.Redirect\n */\nexport class AttributeRedirect extends Redirect\n{\n    public source: string | Function;\n    public glslIdentifer: string;\n    public type: string;\n    public size: number | '%notarray%';\n    public glType: PIXI.TYPES;\n    public glSize: number;\n    public normalize: boolean;\n\n    public properSize: number;\n\n    constructor(source: string | Function, glslIdentifer: string,\n        type = 'float32', size: number | '%notarray%' = 0,\n        glType = PIXI.TYPES.FLOAT, glSize: number,\n        normalize = false)\n    {\n        super(source, glslIdentifer);\n\n        /**\n         * View on the source buffer that should be used to\n         * extract data.\n         *\n         * @member {string}\n         * @see PIXI.ViewableBuffer#view\n         */\n        this.type = type;\n\n        /**\n         * Number of elements to extract out of `source` with\n         * the given view type, for one vertex.\n         *\n         * If source isn't an array (only one element), then\n         * you can set this to `'%notarray%'`.\n         *\n         * @member {number | '%notarray%'}\n         */\n        this.size = size;\n\n        /**\n         * This is equal to `size` or 1 if size is `%notarray%`.\n         *\n         * @member {number}\n         */\n        this.properSize = (size === '%notarray%') ? 1 : size;\n\n        /**\n         * Type of attribute, when uploading.\n         *\n         * Normally, you would use the corresponding type for\n         * the view on source. However, to speed up uploads\n         * you can aggregate attribute values in larger data\n         * types. For example, an RGBA vec4 (byte-sized channels)\n         * can be represented as one `Uint32`, while having\n         * a `glType` of `UNSIGNED_BYTE`.\n         *\n         * @member {PIXI.TYPES}\n         */\n        this.glType = glType;\n\n        /**\n         * Size of attribute in terms of `glType`.\n         *\n         * Note that `glSize * glType <= size * type`\n         *\n         * @readonly\n         */\n        this.glSize = glSize;\n\n        /**\n         * Whether to normalize the attribute values.\n         *\n         * @member {boolean}\n         * @readonly\n         */\n        this.normalize = normalize;\n    }\n\n    static vertexSizeFor(attributeRedirects: Array<AttributeRedirect>): number\n    {\n        return attributeRedirects.reduce(\n            (acc, redirect) =>\n                (PIXI.ViewableBuffer.sizeOf(redirect.type)\n                    * redirect.properSize)\n                + acc,\n            0);\n    }\n}\n","import { Batch } from './Batch';\n\n/**\n * Used to generate discrete groups/batches of display-objects\n * that can be drawn together. It also keeps a parallel buffer\n * of textures.\n *\n * This class ensures that the WebGL states are equivalent and\n * the texture count doesn't become greater than the no. of\n * texture registers on the GPU. You can extend it and add\n * constraints by overriding `onPut`.\n *\n * WARNING: `BatchRenderer` does not support geometry\n *              packing with texture reduction disabled.\n *\n * @memberof PIXI.brend\n * @class\n */\nclass BatchGenerator\n{\n    public readonly enableTextureReduction: boolean;\n\n    protected _state: PIXI.State;\n    protected _textureIncrement: number;\n    protected _textureLimit: number;\n    protected _textureProperty: number;\n    /** @internal */\n    public _batchBuffer: Array<PIXI.DisplayObject>;\n    protected _textureBuffer: any;\n    protected _textureBufferLength: number;\n    protected _textureIndexedBuffer: Array<PIXI.BaseTexture>;\n    protected _textureIndexMap: any;\n\n    protected _putTexture: any;\n\n    /**\n     * @param {number} textureIncrement - textures per object\n     * @param {number} textureLimit - no. of texture registers in GPU\n     * @param {string} textureProperty - property where texture is kept\n     * @param {boolean} [enableTextureReduction=true] - whether same textures\n     *      aren't counted multiple times. This reduces draw calls and can\n     *      draw huge amounts of objects at the same time. For example,\n     *      if 1000 objects use the same texture, then they can be drawn\n     *      together. Further more if 1000 object use the same 8 textures\n     *      randomly, then they can be drawn together. (provided other\n     *      constraints like state are satisfied.)\n     */\n    constructor(\n        textureIncrement,\n        textureLimit,\n        textureProperty,\n        enableTextureReduction = true,\n    )\n    {\n        /** @private */\n        this._state = null;\n        /** @private */\n        this._textureIncrement = textureIncrement;\n        /** @private */\n        this._textureLimit = textureLimit;\n        /** @private */\n        this._textureProperty = textureProperty;\n        /** @private */\n        this._batchBuffer = [];\n        /** @private */\n        this._textureBuffer = {}; // uid : texture map\n        /** @private */\n        this._textureBufferLength = 0;\n        /** @private */\n        this._textureIndexedBuffer = []; // array of textures\n        /** @private */\n        this._textureIndexMap = {}; // uid : index in above\n        /** @protected */\n        this.enableTextureReduction = enableTextureReduction;\n\n        // this._putTexture is used to handle texture buffering!\n        if (enableTextureReduction)\n        {\n            if (textureIncrement === 1)\n            {\n                /** @private */\n                this._putTexture = this._putOnlyTexture;\n            }\n            else\n            {\n                this._putTexture = this._putTextureArray;\n            }\n        }\n        else if (textureIncrement === 1)\n        {\n            this._putTexture = this._putTextureWithoutReduction;\n        }\n        else\n        {\n            this._putTexture = this._putTextureArrayWithoutReduction;\n        }\n    }\n\n    /**\n     * Overridable method that is called before an object\n     * is put into this batch. It should check compatibility\n     * with other objects, and return true/false accordingly.\n     *\n     * @param targetObject {PIXI.DisplayObject} - object being added\n     * @protected\n     */\n    onPut(targetObject: PIXI.DisplayObject): boolean // eslint-disable-line @typescript-eslint/no-unused-vars\n    {\n        return true;\n    }\n\n    /**\n     * Put an object into this batch.\n     *\n     * @param targetObject {PIXI.DisplayObject} - object to add\n     * @param state {PIXI.State} - state required by that object\n     * @return {boolean} whether the object was added to the\n     *     batch. If it wasn't, you should finalize it.\n     */\n    put(targetObject: PIXI.DisplayObject, state: PIXI.State): boolean\n    {\n        if (!this._state)\n        {\n            this._state = state;\n        }\n        else if (this._state.data !== state.data)\n        {\n            return false;\n        }\n\n        if (!this.onPut(targetObject))\n        {\n            return false;\n        }\n\n        if (this._textureIncrement > 0\n            && !this._putTexture(targetObject[this._textureProperty]))\n        {\n            return false;\n        }\n\n        this._batchBuffer.push(targetObject);\n\n        return true;\n    }\n\n    /**\n     * Finalize this batch by getting its data into a\n     * `Batch` object.\n     *\n     * @param batch {PIXI.brend.Batch}\n     */\n    finalize(batch: Batch): void\n    {\n        batch.batchBuffer = this._batchBuffer;\n        batch.textureBuffer = this._textureIndexedBuffer;\n        batch.uidMap = this.enableTextureReduction\n            ? this._textureIndexMap : null;\n        batch.state = this._state;\n\n        this._state = null;\n        this._batchBuffer = [];\n        this._textureBuffer = {};\n        this._textureIndexMap = {};\n        this._textureBufferLength = 0;\n        this._textureIndexedBuffer = [];\n    }\n\n    _putOnlyTexture(texture: PIXI.Texture): boolean\n    {\n        if (texture.baseTexture)\n        {\n            texture = texture.baseTexture;\n        }\n\n        const baseTexture: PIXI.BaseTexture = texture as PIXI.BaseTexture;\n\n        if (this._textureBuffer[baseTexture.uid])\n        {\n            return true;\n        }\n        else if (this._textureBufferLength + 1 <= this._textureLimit)\n        {\n            this._textureBuffer[baseTexture.uid] = texture;\n            this._textureBufferLength += 1;\n\n            const newLength = this._textureIndexedBuffer.push(baseTexture);\n            const index = newLength - 1;\n\n            this._textureIndexMap[baseTexture.uid] = index;\n\n            return true;\n        }\n\n        return false;\n    }\n\n    _putTextureArray(textureArray: Array<PIXI.Texture>): boolean\n    {\n        let deltaBufferLength = 0;\n\n        for (let i = 0; i < textureArray.length; i++)\n        {\n            const texture = textureArray[i].baseTexture\n                ? textureArray[i].baseTexture\n                : textureArray[i];\n\n            if (!this._textureBuffer[texture.uid])\n            {\n                ++deltaBufferLength;\n            }\n        }\n\n        if (deltaBufferLength + this._textureBufferLength > this._textureLimit)\n        {\n            return false;\n        }\n\n        for (let i = 0; i < textureArray.length; i++)\n        {\n            const texture = textureArray[i].baseTexture\n                ? textureArray[i].baseTexture\n                : textureArray[i];\n\n            if (!this._textureBuffer[texture.uid])\n            {\n                this._textureBuffer[texture.uid] = texture;\n                this._textureBufferLength += 1;\n\n                const newLength = this._textureIndexedBuffer.push(texture);\n                const index = newLength - 1;\n\n                this._textureIndexMap[texture.uid] = index;\n            }\n        }\n\n        return true;\n    }\n\n    _putTextureWithoutReduction(texture: PIXI.BaseTexture): boolean\n    {\n        if (texture.baseTexture)\n        {\n            texture = texture.baseTexture;\n        }\n\n        if (this._textureBufferLength + 1 > this._textureLimit)\n        {\n            return false;\n        }\n\n        this._textureIndexedBuffer.push(texture);\n\n        return true;\n    }\n\n    _putTextureArrayWithoutReduction(textureArray: Array<PIXI.Texture>): boolean\n    {\n        if (this._textureBufferLength + textureArray.length\n            > this._textureLimit)\n        {\n            return false;\n        }\n\n        for (let i = 0; i < textureArray.length; i++)\n        {\n            this._textureIndexedBuffer.push(\n                textureArray[i].baseTexture\n                    ? textureArray[i].baseTexture\n                    : textureArray[i],\n            );\n        }\n\n        return true;\n    }\n}\n\nexport { BatchGenerator };\n\nexport default BatchGenerator;\n","import * as PIXI from 'pixi.js';\n\n/**\n * Resources that need to be uploaded to WebGL to render\n * one batch.\n *\n * @memberof PIXI.brend\n * @class\n */\nexport class Batch\n{\n    geometryOffset: number;\n    uidMap: Map<number, number>;\n    state: PIXI.State;\n\n    batchBuffer: Array<PIXI.DisplayObject>;\n    textureBuffer: Array<PIXI.BaseTexture>;\n\n    constructor(geometryOffset: number)\n    {\n        /**\n         * Offset in the geometry (set by `BatchRenderer`)\n         * where this batch is located.\n         *\n         * @member {number}\n         */\n        this.geometryOffset = geometryOffset;\n\n        /**\n         * Buffer of textures that should be uploaded in-order\n         * to GPU texture registers.\n         *\n         * @member {Array<PIXI.Texture>}\n         */\n        this.textureBuffer = null;\n\n        /**\n         * Map of texture-ids into texture-buffer indices.\n         *\n         * @member {Map<number, number>}\n         */\n        this.uidMap = null;\n\n        /**\n         * State required to render this batch.\n         *\n         * @member {PIXI.State}\n         */\n        this.state = null;\n    }\n\n    /**\n     * Uploads the resources required before rendering this\n     * batch.\n     */\n    upload(renderer: PIXI.Renderer): void\n    {\n        this.textureBuffer.forEach((tex, i) =>\n        {\n            renderer.texture.bind(tex, i);\n        });\n\n        renderer.state.set(this.state);\n    }\n\n    /**\n     * Resets all properties to `null` to free up references\n     * to resources.\n     */\n    reset(): void\n    {\n        this.textureBuffer\n            = this.uidMap\n                = this.state\n                    = null;\n    }\n}\n","import { AttributeRedirect } from './redirects/AttributeRedirect';\nimport * as PIXI from 'pixi.js';\nimport Redirect from './redirects/Redirect';\n\nconst CompilerConstants = {\n    INDICES_OFFSET: '__offset_indices_',\n    FUNC_SOURCE_BUFFER: 'getSourceBuffer',\n\n    packerArguments: [\n        'targetObject',\n        'compositeAttributes',\n        'compositeIndices',\n        'aIndex',\n        'iIndex',\n        'textureId',\n        'attributeRedirects',\n    ],\n};\n\n/**\n * Packs the geometry of display-object batches into a\n * composite attribute and index buffer.\n *\n * It works by generating an optimized packer function,\n * which can add objects to the composite geometry. This\n * geometry is interleaved and is in accordance with\n * what {@link PIXI.brend.BatchRenderer.generateCompositeGeometry}\n * would return.\n *\n * @memberof PIXI.brend\n * @class\n */\nexport class GeometryPacker\n{\n    _targetCompositeAttributeBuffer: PIXI.ViewableBuffer;\n    _targetCompositeIndexBuffer: Uint16Array;\n    _aIndex: number;\n    _iIndex: number;\n\n    _attributeRedirects: AttributeRedirect[];\n    _indexProperty: string;\n    _vertexCountProperty: string | number;\n    _vertexSize: number;\n    _texturePerObject: number;\n\n    protected _aBuffers: PIXI.ViewableBuffer[];\n    protected _iBuffers: Uint16Array[];\n\n    _packerFunction: Function;\n\n    /**\n     * @param {PIXI.brend.AttributeRedirect[]} attributeRedirects\n     * @param {string} indexProperty - property where indicies are\n     *     kept; null/undefined if not required.\n     * @param {string | number} vertexCountProperty - property where\n     *      no. of vertices for each object are kept. This could also\n     *      be a constant.\n     * @param {number} vertexSize - vertex size, calculated by\n     *     default. This should exclude the vertex attribute\n     * @param {number} texturePerObject - no. of textures per object\n     */\n    constructor(attributeRedirects: AttributeRedirect[], indexProperty: string, vertexCountProperty: string | number,\n        vertexSize = AttributeRedirect.vertexSizeFor(attributeRedirects),\n        texturePerObject)\n    {\n        vertexSize += texturePerObject * 4;// texture indices are also passed\n\n        this._targetCompositeAttributeBuffer = null;\n        this._targetCompositeIndexBuffer = null;\n        this._aIndex = 0;\n        this._iIndex = 0;\n\n        this._attributeRedirects = attributeRedirects;\n        this._indexProperty = indexProperty;\n        this._vertexCountProperty = vertexCountProperty;\n        this._vertexSize = vertexSize;\n        this._texturePerObject = texturePerObject;\n\n        this._aBuffers = [];// @see _getAttributeBuffer\n        this._iBuffers = [];// @see _getIndexBuffer\n    }\n\n    /**\n     * A generated function that will append an object's\n     * attributes and indices to composite buffers.\n     *\n     * The composite attribute buffer is interleaved.\n     *\n     * The composite index buffer has adjusted indices. It\n     * accounts for the new positions of vertices in the\n     * composite attribute buffer.\n     *\n     * You can overwrite this property with a custom packer\n     * function.\n     *\n     * @member {PIXI.brend.PackerFunction}\n     */\n    get packerFunction(): Function\n    {\n        if (!this._packerFunction)\n        {\n            this._packerFunction\n                = new FunctionCompiler(this).compile();// eslint-disable-line\n        }\n\n        return this._packerFunction;\n    }\n\n    set packerFunction(func: Function)// eslint-disable-line require-jsdoc\n    {\n        this._packerFunction = func;\n    }\n\n    /**\n     * This is the currently active composite attribute\n     * buffer. It may contain garbage in unused locations.\n     *\n     * @member {PIXI.ViewableBuffer}\n     */\n    get compositeAttributes(): PIXI.ViewableBuffer\n    {\n        return this._targetCompositeAttributeBuffer;\n    }\n\n    /**\n     * This is the currently active composite index\n     * buffer. It may contain garbage in unused locations.\n     *\n     * It will be `null` if `indexProperty` was not given.\n     *\n     * @member {Uint16Array}\n     */\n    get compositeIndices(): Uint16Array\n    {\n        return this._targetCompositeIndexBuffer;\n    }\n\n    /**\n     * @param {number} batchVertexCount\n     * @param {number} batchIndexCount\n     */\n    reset(batchVertexCount: number, batchIndexCount: number): void\n    {\n        this._targetCompositeAttributeBuffer\n            = this.getAttributeBuffer(batchVertexCount);\n\n        if (this._indexProperty)\n        {\n            this._targetCompositeIndexBuffer\n                = this.getIndexBuffer(batchIndexCount);\n        }\n\n        this._aIndex = this._iIndex = 0;\n    }\n\n    /**\n     * @param {PIXI.DisplayObject} targetObject\n     * @param {number} textureId\n     */\n    pack(targetObject: PIXI.DisplayObject, textureId: number): void\n    {\n        this.packerFunction(\n            targetObject,\n            this._targetCompositeAttributeBuffer,\n            this._targetCompositeIndexBuffer,\n            this._aIndex,\n            this._iIndex,\n            textureId,\n            this._attributeRedirects,\n        );\n    }\n\n    protected getAttributeBuffer(size: number): PIXI.ViewableBuffer\n    {\n        // 8 vertices is enough for 2 quads\n        const roundedP2 = PIXI.utils.nextPow2(Math.ceil(size / 8));\n        const roundedSizeIndex = PIXI.utils.log2(roundedP2);\n        const roundedSize = roundedP2 * 8;\n\n        if (this._aBuffers.length <= roundedSizeIndex)\n        {\n            this._aBuffers.length = roundedSizeIndex + 1;\n        }\n\n        let buffer = this._aBuffers[roundedSizeIndex];\n\n        if (!buffer)\n        {\n            this._aBuffers[roundedSize] = buffer\n                = new PIXI.ViewableBuffer(roundedSize * this._vertexSize);\n        }\n\n        return buffer;\n    }\n\n    protected getIndexBuffer(size: number): Uint16Array\n    {\n        // 12 indices is enough for 2 quads\n        const roundedP2 = PIXI.utils.nextPow2(Math.ceil(size / 12));\n        const roundedSizeIndex = PIXI.utils.log2(roundedP2);\n        const roundedSize = roundedP2 * 12;\n\n        if (this._iBuffers.length <= roundedSizeIndex)\n        {\n            this._iBuffers.length = roundedSizeIndex + 1;\n        }\n\n        let buffer = this._iBuffers[roundedSizeIndex];\n\n        if (!buffer)\n        {\n            this._iBuffers[roundedSizeIndex] = buffer\n                = new Uint16Array(roundedSize);\n        }\n\n        return buffer;\n    }\n}\n\n// FunctionCompiler was intented to be a static inner\n// class in GeometryPacker. However, due to a bug in\n// JSDoc (3.6.3), I've put it down here :)\n//\n// https://github.com/jsdoc/jsdoc/issues/1673\n\nconst FunctionCompiler = class\n{\n    packer: GeometryPacker;\n\n    /**\n     * @param {PIXI.brend.GeometryPacker} packer\n     */\n    constructor(packer)\n    {\n        this.packer = packer;\n    }\n\n    compile(): Function\n    {\n        const packer = this.packer;\n\n        let packerBody = ``;\n\n        /* Source offset variables for attribute buffers &\n            the corresponding buffer-view references. */\n        packer._attributeRedirects.forEach((redirect, i) =>\n        {\n            packerBody += `\n                let __offset_${i} = 0;\n                const __buffer_${i} = (\n                    ${this._compileSourceBufferExpression(redirect, i)});\n            `;\n        });\n\n        /* Basis for the \"packing\" for-loop. */\n        packerBody += `\n            const {\n                int8View,\n                uint8View,\n                int16View,\n                uint16View,\n                int32View,\n                uint32View,\n                float32View,\n            } = compositeAttributes;\n\n            const vertexCount = ${this._compileVertexCountExpression()};\n\n            let adjustedAIndex = 0;\n\n            for (let vertexIndex = 0; vertexIndex < vertexCount; vertexIndex++)\n            {\n        `;\n\n        // Eliminate offset conversion when adjacent attributes\n        // have similar source-types.\n        let skipReverseTransformation = false;\n\n        /* Packing for-loop body. */\n        for (let i = 0; i < packer._attributeRedirects.length; i++)\n        {\n            const redirect = packer._attributeRedirects[i];\n\n            /* Initialize adjsutedAIndex in terms of source type. */\n            if (!skipReverseTransformation)\n            {\n                packerBody += `\n                    adjustedAIndex = aIndex / ${this._sizeOf(i)};\n                `;\n            }\n\n            if (typeof redirect.size === 'number')\n            {\n                for (let j = 0; j < redirect.size; j++)\n                {\n                    packerBody += `\n                        ${redirect.type}View[adjustedAIndex++] =\n                            __buffer_${i}[__offset_${i}++];\n                    `;\n                }\n            }\n            else\n            {\n                packerBody += `\n                        ${redirect.type}View[adjustedAIndex++] =\n                            __buffer_${i};\n                `;\n            }\n\n            if (packer._attributeRedirects[i + 1]\n                && (this._sizeOf(i + 1) !== this._sizeOf(i)))\n            {\n                packerBody += `\n                    aIndex = adjustedAIndex * ${this._sizeOf(i)};\n                `;\n            }\n            else\n            {\n                skipReverseTransformation = true;\n            }\n        }\n\n        if (skipReverseTransformation)\n        {\n            if (this._sizeOf(packer._attributeRedirects.length - 1)\n                    !== 4)\n            {\n                packerBody += `\n                    aIndex = adjustedAIndex * ${this._sizeOf(\n        packer._attributeRedirects.length - 1)}\n                `;\n                skipReverseTransformation = false;\n            }\n        }\n\n        if (packer._texturePerObject > 0)\n        {\n            if (packer._texturePerObject > 1)\n            {\n                if (!skipReverseTransformation)\n                {\n                    packerBody += `\n                        adjustedAIndex = aIndex / 4;\n                    `;\n                }\n\n                for (let k = 0; k < packer._texturePerObject; k++)\n                {\n                    packerBody += `\n                        float32View[adjustedAIndex++] = textureId[${k}];\n                    `;\n                }\n\n                packerBody += `\n                    aIndex = adjustedAIndex * 4;\n                `;\n            }\n            else if (!skipReverseTransformation)\n            {\n                packerBody += `\n                    float32View[aIndex] = textureId;\n                    aIndex += 4;\n                `;\n            }\n            else\n            {\n                packerBody += `\n                    float32View[adjustedAIndex++] = textureId;\n                    aIndex = adjustedAIndex * 4;\n                `;\n            }\n        }\n\n        /* Close the packing for-loop. */\n        packerBody += `}\n            ${this.packer._indexProperty\n        ? `const oldAIndex = this._aIndex;`\n        : ''}\n            this._aIndex = aIndex;\n        `;\n\n        if (this.packer._indexProperty)\n        {\n            packerBody += `\n                const verticesBefore = oldAIndex / ${this.packer._vertexSize}\n                const indexCount\n                    = targetObject['${this.packer._indexProperty}'].length;\n\n                for (let j = 0; j < indexCount; j++)\n                {\n                    compositeIndices[iIndex++] = verticesBefore +\n                        targetObject['${this.packer._indexProperty}'][j];\n                }\n\n                this._iIndex = iIndex;\n            `;\n        }\n\n        // eslint-disable-next-line no-new-func\n        return new Function(\n            ...CompilerConstants.packerArguments,\n            packerBody);\n    }\n\n    _compileSourceBufferExpression(redirect: Redirect, i: number): string\n    {\n        return (typeof redirect.source === 'string')\n            ? `targetObject['${redirect.source}']`\n            : `attributeRedirects[${i}].source(targetObject)`;\n    }\n\n    _compileVertexCountExpression(): string\n    {\n        if (!this.packer._vertexCountProperty)\n        {\n            // auto-calculate based on primary attribute\n            return `__buffer_0.length / ${\n                this.packer._attributeRedirects[0].size}`;\n        }\n\n        return (\n            (typeof this.packer._vertexCountProperty === 'string')\n                ? `targetObject.${this.packer._vertexCountProperty}`\n                : `${this.packer._vertexCountProperty}`\n        );\n    }\n\n    _sizeOf(i: number): number\n    {\n        return PIXI.ViewableBuffer.sizeOf(\n            this.packer._attributeRedirects[i].type);\n    }\n};\n\nexport default GeometryPacker;\n","import * as PIXI from 'pixi.js';\n\nexport function resolveConstantOrProperty(targetObject: PIXI.DisplayObject, property: string | number): any\n{\n    return (typeof property === 'string')\n        ? targetObject[property]\n        : property;\n}\n\nexport default resolveConstantOrProperty;\n","import * as PIXI from 'pixi.js';\n\nexport function resolveFunctionOrProperty(targetObject: PIXI.DisplayObject, property: Function | string): any\n{\n    return (typeof property === 'string')\n        ? targetObject[property]\n        : property(targetObject);\n}\n\nexport default resolveFunctionOrProperty;\n","import { Batch } from './Batch';\nimport { BatchGenerator } from './BatchGenerator';\nimport { GeometryPacker } from './GeometryPacker';\nimport * as PIXI from 'pixi.js';\nimport { resolveConstantOrProperty, resolveFunctionOrProperty } from './resolve';\nimport { AttributeRedirect } from './redirects/AttributeRedirect';\n\n/**\n * Core class that renders objects in batches. Clients should\n * defer rendering to a `BatchRenderer` instance by registering\n * it as a plugin.\n *\n * @memberof PIXI.brend\n * @class\n * @extends PIXI.ObjectRenderer\n */\nexport class BatchRenderer extends PIXI.ObjectRenderer\n{\n    _attributeRedirects: AttributeRedirect[];\n    _indexProperty: string;\n    _vertexCountProperty: string | number;\n    _textureProperty: string;\n    _texturePerObject: number;\n    _textureAttribute: string;\n    _stateFunction: Function;\n    _shaderFunction: Function;\n\n    _BatchGeneratorClass: typeof BatchGenerator;\n    _batchGenerator: BatchGenerator;\n\n    _packer: GeometryPacker;\n    _geom: PIXI.Geometry;\n\n    _objectBuffer: PIXI.DisplayObject[];\n    _bufferedVertices: number;\n    _bufferedIndices: number;\n\n    _shader: PIXI.Shader;\n\n    _batchPool: Array<Batch>;\n    _batchCount: number;\n\n    MAX_TEXTURES: number;\n\n    /**\n     * @param {PIXI.Renderer} renderer - renderer to attach to\n     * @param {PIXI.brend.AttributeRedirect[]} attributeRedirects\n     * @param {string | null} indexProperty\n     * @param {string | number} vertexCountProperty\n     * @param {string | null} textureProperty\n     * @param {number} texturePerObject\n     * @param {string} textureAttribute - name of texture-id attribute variable\n     * @param {Function} stateFunction - returns a {PIXI.State} for an object\n     * @param {Function} shaderFunction - generates a shader given this instance\n     * @param {PIXI.brend.GeometryPacker} [packer=new PIXI.brend.GeometryPacker]\n     * @param {Class} [BatchGeneratorClass=PIXI.brend.BatchGenerator]\n     * @see PIXI.brend.ShaderGenerator\n     */\n    constructor(// eslint-disable-line max-params\n        renderer: PIXI.Renderer,\n        attributeRedirects: AttributeRedirect[],\n        indexProperty: string,\n        vertexCountProperty: string | number,\n        textureProperty: string,\n        texturePerObject: number,\n        textureAttribute: string,\n        stateFunction: (BatchRenderer) => PIXI.State,\n        shaderFunction: (BatchRenderer) => PIXI.Shader,\n        packer = new GeometryPacker(\n            attributeRedirects,\n            indexProperty,\n            vertexCountProperty, // auto-calculate\n            undefined,\n            texturePerObject,\n        ),\n        BatchGeneratorClass = BatchGenerator,\n    )\n    {\n        super(renderer);\n\n        this._attributeRedirects = attributeRedirects;\n        this._indexProperty = indexProperty;\n        this._vertexCountProperty = vertexCountProperty;\n        this._textureProperty = textureProperty;\n        this._texturePerObject = texturePerObject;\n        this._textureAttribute = textureAttribute;\n        this._stateFunction = stateFunction;\n        this._shaderFunction = shaderFunction;\n\n        this._BatchGeneratorClass = BatchGeneratorClass;\n        this._batchGenerator = null;// @see this#contextChange\n\n        this.renderer.runners.contextChange.add(this);\n\n        if (this.renderer.gl)// we are late to the party!\n        {\n            this.contextChange();\n        }\n\n        this._packer = packer;\n\n        this._geom = BatchRenderer.generateCompositeGeometry(\n            attributeRedirects,\n            !!indexProperty,\n            textureAttribute,\n            texturePerObject);\n\n        this._objectBuffer = [];\n        this._bufferedVertices = 0;\n        this._bufferedIndices = 0;\n        this._shader = null;\n\n        this._batchPool = [];// may contain garbage after _batchCount\n        this._batchCount = 0;\n    }\n\n    contextChange(): void\n    {\n        const gl = this.renderer.gl;\n\n        if (PIXI.settings.PREFER_ENV === PIXI.ENV.WEBGL_LEGACY)\n        {\n            this.MAX_TEXTURES = 1;\n        }\n        else\n        {\n            this.MAX_TEXTURES = Math.min(\n                gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS),\n                PIXI.settings.SPRITE_MAX_TEXTURES);\n        }\n\n        this._batchGenerator = new this._BatchGeneratorClass(\n            this._texturePerObject, this.MAX_TEXTURES,\n            this._textureProperty, true); // NOTE: Force texture reduction\n\n        if (!this._batchGenerator.enableTextureReduction)\n        {\n            throw new Error('PIXI.brend.BatchRenderer does not support '\n                    + 'batch generation without texture reduction enabled.');\n        }\n    }\n\n    start(): void\n    {\n        this._objectBuffer.length = 0;\n        this._bufferedVertices = 0;\n        this._bufferedIndices = 0;\n\n        this._shader = this._shaderFunction(this);\n\n        if (this._shader.uniforms.uSamplers)\n        {\n            this._shader.uniforms.uSamplers\n                = BatchRenderer.generateTextureArray(this.MAX_TEXTURES);\n        }\n\n        this.renderer.shader.bind(this._shader, false);\n    }\n\n    render(targetObject: PIXI.DisplayObject): void\n    {\n        this._objectBuffer.push(targetObject);\n\n        this._bufferedVertices += this._vertexCountFor(targetObject);\n\n        if (this._indexProperty)\n        {\n            this._bufferedIndices += resolveConstantOrProperty(\n                targetObject, this._indexProperty).length;\n        }\n    }\n\n    flush(): void\n    {\n        const {\n            _batchGenerator: batchGenerator,\n            _geom: geom,\n            _packer: packer,\n            renderer,\n            _stateFunction: stateFunction,\n            _textureProperty: textureProperty,\n            _texturePerObject: texturePerObject,\n        } = this;\n\n        const gl = renderer.gl;\n        const buffer = this._objectBuffer;\n        const bufferLength = buffer.length;\n\n        this._batchCount = 0;\n        packer.reset(this._bufferedVertices, this._bufferedIndices);\n\n        let batchStart = 0;\n\n        // Generate batches/groups that will be drawn using just\n        // one draw call.\n        for (let objectIndex = 0; objectIndex < bufferLength;)\n        {\n            const target = buffer[objectIndex];\n            const wasPut = batchGenerator.put(target,\n                resolveFunctionOrProperty(target, stateFunction));\n\n            if (!wasPut)\n            {\n                batchGenerator.finalize(this._newBatch(batchStart));\n                batchStart = objectIndex;\n            }\n            else\n            {\n                ++objectIndex;\n            }\n        }\n\n        // Generate the last batch, if required.\n        if (batchGenerator._batchBuffer.length !== 0)\n        {\n            batchGenerator.finalize(this._newBatch(batchStart));\n        }\n\n        // Pack each object into the composite geometry. This is done\n        // after batching, so that texture-ids are generated.\n        let textureId = this._texturePerObject === 1\n            ? 0\n            : new Array(texturePerObject);\n\n        for (let i = 0; i < this._batchCount; i++)// loop-per(batch)\n        {\n            const batch = this._batchPool[i];\n            const batchBuffer = batch.batchBuffer;\n            const batchLength = batchBuffer.length;\n            const uidMap = batch.uidMap;\n\n            let vertexCount = 0;// eslint-disable-line\n            let indexCount = 0;\n\n            for (let j = 0; j < batchLength; j++)// loop-per(targetObject)\n            {\n                const targetObject = batchBuffer[j];\n\n                if (this._indexProperty)\n                {\n                    indexCount += resolveConstantOrProperty(\n                        targetObject, this._indexProperty).length;\n                }\n                else\n                {\n                    vertexCount += resolveConstantOrProperty(\n                        targetObject, this._vertexCountProperty);\n                }\n\n                // externally-defined properties for draw calls\n                batch.$vertexCount = vertexCount;\n                batch.$indexCount = indexCount;\n\n                const tex = targetObject[textureProperty];\n\n                let texUID;\n\n                if (texturePerObject === 1)\n                {\n                    texUID = tex.baseTexture\n                        ? tex.baseTexture.uid\n                        : tex.uid;\n\n                    textureId = uidMap[texUID];\n                }\n                else\n                {\n                    let _tex;\n\n                    for (let k = 0; k < tex.length; k++)\n                    {\n                        _tex = tex[k];\n\n                        texUID = _tex.BaseTexture\n                            ? _tex.baseTexture.uid\n                            : _tex.uid;\n\n                        textureId[k] = uidMap[texUID];\n                    }\n                }\n\n                packer.pack(targetObject, textureId);\n            }\n        }\n\n        // Upload the geometry\n        geom.$buffer.update(packer.compositeAttributes.float32View);\n        geom.getIndex().update(packer.compositeIndices);\n        renderer.geometry.bind(geom);\n        renderer.geometry.updateBuffers();\n\n        // Now draw each batch\n        for (let i = 0; i < this._batchCount; i++)\n        {\n            const batch = this._batchPool[i];\n\n            batch.upload();\n\n            if (this._indexProperty)\n            {\n                gl.drawElements(gl.TRIANGLES,\n                    batch.$indexCount,\n                    gl.UNSIGNED_SHORT,\n                    batch.geometryOffset * 2);// * 2 cause Uint16 indices\n            }\n            else\n            {\n                gl.drawArrays(gl.TRIANGLES,\n                    batch.geometryOffset,\n                    batch.$vertexCount);// TODO: *vertexSize\n            }\n\n            batch.reset();\n        }\n    }\n\n    stop(): void\n    {\n        if (this._bufferedVertices)\n        {\n            this.flush();\n        }\n    }\n\n    protected _newBatch(batchStart: number): Batch\n    {\n        if (this._batchCount === this._batchPool.length)\n        {\n            const batch = new Batch(batchStart);\n\n            this._batchPool.push(batch);\n            ++this._batchCount;\n\n            return batch;\n        }\n\n        const batch = this._batchPool[this._batchCount++];\n\n        batch.reset();\n        batch.geometryOffset = batchStart;\n\n        return batch;\n    }\n\n    protected _vertexCountFor(targetObject: PIXI.DisplayObject): number\n    {\n        return (this._vertexCountProperty)\n            ? resolveConstantOrProperty(targetObject, this._vertexCountProperty)\n            : resolveFunctionOrProperty(targetObject,\n                this._attributeRedirects[0].source).length\n                    / (this._attributeRedirects[0].size as number);\n    }\n\n    /**\n     * Generates a `PIXI.Geometry` that can be used for rendering\n     * multiple display objects at once.\n     *\n     * @param {Array<PIXI.brend.AttributeRedirect>} attributeRedirects\n     * @param {boolean} hasIndex - whether to include an index property\n     * @param {string} textureAttribute - name of the texture-id attribute\n     * @param {number} texturePerObject - no. of textures per object\n     */\n    static generateCompositeGeometry(attributeRedirects, hasIndex,\n        textureAttribute, texturePerObject): PIXI.Geometry\n    {\n        const geom = new PIXI.Geometry();\n        const attributeBuffer = new PIXI.Buffer(null, false, false);\n        const indexBuffer = hasIndex ? new PIXI.Buffer(null, false, true) : null;\n\n        attributeRedirects.forEach((redirect) =>\n        {\n            const {\n                glslIdentifer, glType, glSize,\n                normalize,\n            } = redirect;\n\n            geom.addAttribute(glslIdentifer, attributeBuffer,\n                glSize, normalize, glType);\n        });\n\n        if (textureAttribute && texturePerObject > 0)\n        {\n            geom.addAttribute(textureAttribute, attributeBuffer,\n                texturePerObject, true, PIXI.TYPES.FLOAT);\n        }\n\n        if (hasIndex)\n        {\n            geom.addIndex(indexBuffer);\n        }\n\n        geom.$buffer = attributeBuffer;\n\n        // $buffer is attributeBuffer\n        // getIndex() is ?indexBuffer\n        return geom;\n    }\n\n    static generateTextureArray(count: number): Int32Array\n    {\n        const array = new Int32Array(count);\n\n        for (let i = 0; i < count; i++)\n        {\n            array[i] = i;\n        }\n\n        return array;\n    }\n}\n\nexport default BatchRenderer;\n","import { BatchRenderer } from './BatchRenderer';\nimport { AttributeRedirect } from './redirects/AttributeRedirect';\nimport GeometryPacker from './GeometryPacker';\nimport BatchGenerator from './BatchGenerator';\n\n/**\n * Generates a batch-renderer plugin.\n *\n * @memberof PIXI.brend\n * @hideconstructor\n * @class\n */\nexport class BatchRendererPluginFactory\n{\n    /**\n     * @param {PIXI.brend.AttributeRedirect[]} attributeRedirects\n     * @param {string | Array<number>} indexProperty\n     * @param {string | number} vertexCountProperty\n     * @param {string} textureProperty\n     * @param {number} texturePerObject\n     * @param {string} textureAttribute\n     * @param {Function} stateFunction\n     * @param {Function} shaderFunction\n     * @param {PIXI.brend.GeometryPacker} [packer]\n     * @param {Class} [BatchGeneratorClass]\n     * @param {Class} [BatchRendererClass]\n     */\n    static from(/* eslint-disable-line max-params */\n        attributeRedirects: AttributeRedirect[],\n        indexProperty: string,\n        vertexCountProperty: string | number,\n        textureProperty: string,\n        texturePerObject: number,\n        textureAttribute: string,\n        stateFunction: (brend: BatchRenderer) => any,\n        shaderFunction: (brend: BatchRenderer) => any,\n        packer: GeometryPacker,\n        BatchGeneratorClass: typeof BatchGenerator,\n        BatchRendererClass = BatchRenderer,\n    ): typeof BatchRenderer\n    {\n        return class extends BatchRendererClass\n        {\n            constructor(renderer)\n            {\n                super(renderer,\n                    attributeRedirects,\n                    indexProperty,\n                    vertexCountProperty,\n                    textureProperty,\n                    texturePerObject,\n                    textureAttribute,\n                    stateFunction,\n                    shaderFunction,\n                    packer,\n                    BatchGeneratorClass);\n            }\n        };\n    }\n}\n\nexport default BatchRendererPluginFactory;\n","import * as PIXI from 'pixi.js';\nimport BatchRenderer from './BatchRenderer';\n\n// JavaScript is stupid enough not to have a replaceAll\n// in String. This is a temporary solution and we should\n// depend on an actually polyfill.\nfunction _replaceAll(target: string, search: string, replacement: string): string\n{\n    return target.replace(new RegExp(search, 'g'), replacement);\n}\n\nfunction injectTexturesPerBatch(batchRenderer: BatchRenderer): string\n{\n    return `${batchRenderer.MAX_TEXTURES}`;\n}\n\n/**\n * Exposes an easy-to-use API for generating a shader function\n * for batch rendering.\n *\n * You are required to provide an injector map, which maps\n * macros to functions that return a string value for those\n * macros given a renderer.\n *\n * By default, only one injector is used - the textures per\n * batch `%texturesPerBatch%` macro. This is replaced by\n * the number of textures passed to the `uSamplers` textures\n * uniform.\n *\n * @memberof PIXI.brend\n * @class\n */\nclass ShaderGenerator\n{\n    protected _vertexShaderTemplate: string;\n    protected _fragmentShaderTemplate: string;\n    protected _uniforms: any;\n    protected _templateInjectors: any;\n\n    protected disableVertexShaderTemplate: boolean;\n\n    protected _cache: any;\n    protected _cState: any;\n\n    /**\n     * WARNING: Do not pass `uSamplers` in your uniforms. They\n     *  will be added to your shader instance directly.\n     *\n     * @param {string} vertexShaderTemplate\n     * @param {string} fragmentShaderTemplate\n     * @param {UniformGroup | Map<string, object>} uniforms\n     * @param {Object.<String, PIXI.brend.InjectorFunction>} [templateInjectors]\n     * @param {boolean} [disableVertexShaderTemplate=true] - turn off (true)\n     *      if you aren't using macros in the vertex shader\n     */\n    constructor(\n        vertexShaderTemplate: string,\n        fragmentShaderTemplate: string,\n        uniforms = {},\n        templateInjectors = {\n            '%texturesPerBatch%': injectTexturesPerBatch,\n        },\n        disableVertexShaderTemplate = true,\n    )\n    {\n        if (!templateInjectors['%texturesPerBatch%'])\n        {\n            templateInjectors['%texturesPerBatch%'] = injectTexturesPerBatch;\n        }\n\n        /** @protected */\n        this._vertexShaderTemplate = vertexShaderTemplate;\n        /** @protected */\n        this._fragmentShaderTemplate = fragmentShaderTemplate;\n        /** @protected */\n        this._uniforms = uniforms;\n        /** @protected */\n        this._templateInjectors = templateInjectors;\n\n        /**\n         * Disable vertex shader templates to speed up shader\n         * generation.\n         *\n         * @member {Boolean}\n         */\n        this.disableVertexShaderTemplate = disableVertexShaderTemplate;\n\n        /**\n         * Maps the stringifed state of the batch renderer to the\n         * generated shader.\n         *\n         * @private\n         * @member {Object.<String, PIXI.Shader>}\n         */\n        this._cache = {};\n\n        /**\n         * Unstringifed current state of the batch renderer.\n         *\n         * @private\n         * @member {Object.<String, String>}\n         * @see {PIXI.brend.ShaderGenerator#_generateInjectorBasedState}\n         */\n        this._cState = null;\n    }\n\n    /**\n     * @return shader function that can be given to the batch renderer\n     */\n    generateFunction(): (brend: BatchRenderer) => PIXI.Shader\n    {\n        return (batchRenderer: BatchRenderer): PIXI.Shader =>\n        {\n            const stringState = this._generateInjectorBasedState(batchRenderer);\n            const cachedShader = this._cache[stringState];\n\n            if (cachedShader)\n            {\n                return cachedShader;\n            }\n\n            return this._generateShader(stringState);\n        };\n    }\n\n    protected _generateInjectorBasedState(batchRenderer: BatchRenderer): string\n    {\n        let state = '';\n        const cState = this._cState = {};\n\n        for (const injectorMacro in this._templateInjectors)\n        {\n            const val = this._templateInjectors[injectorMacro](batchRenderer);\n\n            state += val;\n            cState[injectorMacro] = val;\n        }\n\n        return state;\n    }\n\n    protected _generateShader(stringState: string): PIXI.Shader\n    {\n        let vertexShaderTemplate = this._vertexShaderTemplate.slice(0);\n\n        let fragmentShaderTemplate = this._fragmentShaderTemplate.slice(0);\n\n        for (const injectorTemplate in this._cState)\n        {\n            if (!this.disableVertexShaderTemplate)\n            {\n                vertexShaderTemplate = _replaceAll(vertexShaderTemplate,\n                    injectorTemplate, this._cState[injectorTemplate]);\n            }\n\n            fragmentShaderTemplate = _replaceAll(fragmentShaderTemplate,\n                injectorTemplate, this._cState[injectorTemplate]);\n        }\n\n        const shader = PIXI.Shader.from(vertexShaderTemplate,\n            fragmentShaderTemplate, this._uniforms);\n\n        this._cache[stringState] = shader;\n\n        return shader;\n    }\n}\n\nexport { ShaderGenerator };\nexport default ShaderGenerator;\n","/**\n * @namespace PIXI\n */\n/**\n * @namespace brend\n * @memberof PIXI\n */\n\nexport { AttributeRedirect } from './redirects/AttributeRedirect';\nexport { BatchGenerator } from './BatchGenerator';\nexport { BatchRenderer } from './BatchRenderer';\nexport { BatchRendererPluginFactory } from './BatchRendererPluginFactory';\nexport { GeometryPacker } from './GeometryPacker';\nexport { Redirect } from './redirects/Redirect';\nexport { ShaderGenerator } from './ShaderGenerator';\n\n/**\n * This function type is used by `GeometryPacker#packerFunction`.\n *\n * It should add to this._aIndex and this._iIndex the number\n * of vertices and indices appended.\n *\n * @function\n * @name PackerFunction\n * @memberof PIXI.brend\n *\n * @param {PIXI.DisplayObject} targetObject - object to pack\n * @param {PIXI.ViewableBuffer} compositeAttributes\n * @param {Uint16Array} compositeIndices\n * @param {number} aIndex - Offset in the composite attribute buffer\n *      in bytes at which the object's geometry should be inserted.\n * @param {number} iIndex - Number of vertices already packed in the\n *      composite index buffer.\n * @param {Array<PIXI.brend.AttributeRedirect>} attributeRedirects\n * @return {void}\n * @see PIXI.brend.GeometryPacker#packerFunction\n */\n\n/**\n * @function\n * @name InjectorFunction\n * @memberof PIXI.brend\n *\n * @param {PIXI.brend.BatchRenderer} batchRenderer\n * @return {string} value of the macro for this renderer\n */\n"],"names":["PIXI.TYPES","PIXI.ViewableBuffer","PIXI.utils","PIXI.settings","PIXI.ENV","PIXI.Geometry","PIXI.Buffer","PIXI.ObjectRenderer","PIXI.Shader"],"mappings":"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"}